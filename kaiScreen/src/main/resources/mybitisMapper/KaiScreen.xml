<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bonc.mapper.KaiScreenMapper">
<!--    当前时间的医院排名信息,医院名 hospitalNameList,医院id hospitalId和排名 hospitalRank-->
    <select id="selectOutpatientsRankList" resultType="java.util.HashMap">
        SELECT
            a.hospital_desc hospitalNameList,
            a.hospital_id hospitalId,
            a.rank_desc hospitalRank
        FROM
            outpatients_hospitalrank a
        WHERE
            a.day_time = #{nowTime}
    </select>
<!--    实时门诊分布情况,门诊名 dataX,占比 chartData-->
    <select id="selectOutpatientsPieData" resultType="java.util.HashMap">
        SELECT
            a.department_desc dataX,
            a.proportion chartData
        FROM
            outpatients_departmentrank_a a
        WHERE
            a.day_time = #{nowTime}
    </select>
<!--    分时段趋势图数据 , 时间点 dataX, 人数 chartData-->
    <select id="selectOutpatientsLineData" resultType="java.util.HashMap">
        SELECT
            a.interval_time dataX,
            a.total_num chartData
        FROM
            outpatients_hospitalrank a
        WHERE
            a.hospital_id = #{hospitalId}
    </select>
<!--    门诊累计统计表数据,科室名称  depName, 人数 nums, 占比 proper-->
    <select id="selectOutpatientsTableData" resultType="java.util.HashMap">
        SELECT
            a.department_desc depName,
            a.total_num nums,
            a.proportion proper
        FROM
            outpatients_departmentrank_h a
        WHERE
            a.hospital_id = #{hospitalId}
            AND a.day_time = #{nowTime}
    </select>
<!--    当前时间的参加门诊的人数-->
    <select id="selectOutpatientsPopulationByTime" resultType="int">
        SELECT
            a.hour_num
        FROM
            outpatients_hour_num a
        WHERE
            a.day_time = #{nowTime}
    </select>
<!--    当前日期 date , 门诊医院名 hospitalName , 所有部门 department和对应的人数 num-->
    <select id="selectOutpatientsHospital" resultType="java.util.HashMap">
        SELECT
            a.day_id date,
            a.hospital_desc hospitalName,
            a.department_desc department,
            a.total_num num
        FROM
            outpatients_departmentrank_h a
        WHERE
            a.day_time = '2018032301'
        GROUP BY
            a.day_id,
            a.hospital_desc,
            a.total_num,
            a.department_desc
    </select>

</mapper>